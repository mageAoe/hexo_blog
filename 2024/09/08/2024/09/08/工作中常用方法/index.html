<!DOCTYPE html>


<html lang="zh-CN">
  

    <head>
      <meta charset="utf-8" />
        
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title>工作中常用方法JS |  个人博客</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.ico" />
       
<link rel="stylesheet" href="/hexo_blog/dist/main.css">

      
<link rel="stylesheet" href="/hexo_blog/css/fonts/remixicon.css">

      
<link rel="stylesheet" href="/hexo_blog/css/custom.css">
 
      <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    </head>
  </html>
</html>


<body>
  <div id="app">
    
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-2024/09/08/工作中常用方法"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  工作中常用方法JS
</h1>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/hexo_blog/2024/09/08/2024/09/08/%E5%B7%A5%E4%BD%9C%E4%B8%AD%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95/" class="article-date">
  <time datetime="2024-09-07T16:00:00.000Z" itemprop="datePublished">2024-09-08</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/hexo_blog/categories/JavaScript/">JavaScript</a> / <a class="article-category-link" href="/hexo_blog/categories/JavaScript/%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95/">常用方法</a>
  </div>
  
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> 字数统计:</span>
            <span class="post-count">2.9k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> 阅读时长≈</span>
            <span class="post-count">16 分钟</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <p>工作中常用方法</p>
<span id="more"></span>

<h3 id="通过生日计算年龄"><a href="#通过生日计算年龄" class="headerlink" title="通过生日计算年龄"></a>通过生日计算年龄</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//通过生日计算年龄</span></span><br><span class="line"><span class="keyword">let</span> jsGetAge = <span class="keyword">function</span> (<span class="params">strBirthday</span>) &#123;</span><br><span class="line">  <span class="comment">//如果为空返回空字符串</span></span><br><span class="line">  <span class="keyword">if</span> (!strBirthday) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> returnAge</span><br><span class="line">  <span class="keyword">let</span> oDate = <span class="keyword">new</span> <span class="title class_">Date</span>(strBirthday)</span><br><span class="line">  <span class="keyword">let</span> birthYear = oDate.<span class="title function_">getFullYear</span>()</span><br><span class="line">  <span class="keyword">let</span> birthMonth = oDate.<span class="title function_">getMonth</span>() + <span class="number">1</span></span><br><span class="line">  <span class="keyword">let</span> birthDay = oDate.<span class="title function_">getDate</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> d = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">  <span class="keyword">let</span> nowYear = d.<span class="title function_">getFullYear</span>()</span><br><span class="line">  <span class="keyword">let</span> nowMonth = d.<span class="title function_">getMonth</span>() + <span class="number">1</span></span><br><span class="line">  <span class="keyword">let</span> nowDay = d.<span class="title function_">getDate</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (nowYear == birthYear) &#123;</span><br><span class="line">    returnAge = <span class="number">0</span> <span class="comment">//同年 则为0岁</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> ageDiff = nowYear - birthYear <span class="comment">//年之差</span></span><br><span class="line">    <span class="keyword">if</span> (ageDiff &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (nowMonth == birthMonth) &#123;</span><br><span class="line">        <span class="keyword">let</span> dayDiff = nowDay - birthDay <span class="comment">//日之差</span></span><br><span class="line">        <span class="keyword">if</span> (dayDiff &lt; <span class="number">0</span>) &#123;</span><br><span class="line">          returnAge = ageDiff - <span class="number">1</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          returnAge = ageDiff</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> monthDiff = nowMonth - birthMonth <span class="comment">//月之差</span></span><br><span class="line">        <span class="keyword">if</span> (monthDiff &lt; <span class="number">0</span>) &#123;</span><br><span class="line">          returnAge = ageDiff - <span class="number">1</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          returnAge = ageDiff</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      returnAge = <span class="string">&#x27;&#x27;</span> <span class="comment">//返回-1 表示出生日期输入错误 晚于今天</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> returnAge <span class="comment">//返回周岁年龄</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="设置cookie"><a href="#设置cookie" class="headerlink" title="设置cookie"></a>设置cookie</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置cookie</span></span><br><span class="line"><span class="keyword">let</span> setCookie = <span class="keyword">function</span> (<span class="params">c_name, value, expiredays</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> exdate = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">  exdate.<span class="title function_">setDate</span>(exdate.<span class="title function_">getDate</span>() + expiredays)</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">cookie</span> =</span><br><span class="line">    c_name + <span class="string">&#x27;=&#x27;</span> + <span class="built_in">escape</span>(value) + (expiredays == <span class="literal">null</span> ? <span class="string">&#x27;&#x27;</span> : <span class="string">&#x27;;expires=&#x27;</span> + exdate.<span class="title function_">toGMTString</span>())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="获取cookie"><a href="#获取cookie" class="headerlink" title="获取cookie"></a>获取cookie</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取cookie</span></span><br><span class="line"><span class="keyword">let</span> getCookie = <span class="keyword">function</span> (<span class="params">c_name</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> search = c_name + <span class="string">&#x27;=&#x27;</span> <span class="comment">//查询检索的值</span></span><br><span class="line">  <span class="keyword">let</span> returnvalue = <span class="string">&#x27;&#x27;</span> <span class="comment">//返回值</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">cookie</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> sd = <span class="variable language_">document</span>.<span class="property">cookie</span>.<span class="title function_">indexOf</span>(search)</span><br><span class="line">    <span class="keyword">if</span> (sd != -<span class="number">1</span>) &#123;</span><br><span class="line">      sd += search.<span class="property">length</span></span><br><span class="line">      <span class="keyword">let</span> end = <span class="variable language_">document</span>.<span class="property">cookie</span>.<span class="title function_">indexOf</span>(<span class="string">&#x27;;&#x27;</span>, sd)</span><br><span class="line">      <span class="keyword">if</span> (end == -<span class="number">1</span>) end = <span class="variable language_">document</span>.<span class="property">cookie</span>.<span class="property">length</span></span><br><span class="line">      <span class="comment">//unescape() 函数可对通过 escape() 编码的字符串进行解码。</span></span><br><span class="line">      returnvalue = <span class="built_in">unescape</span>(<span class="variable language_">document</span>.<span class="property">cookie</span>.<span class="title function_">substring</span>(sd, end))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> returnvalue</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="单个if语句优化"><a href="#单个if语句优化" class="headerlink" title="单个if语句优化"></a>单个if语句优化</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">flag &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">handleFn</span>()</span><br><span class="line"><span class="comment">// handleFn是普通函数</span></span><br></pre></td></tr></table></figure>

<h3 id="if-else语句优化"><a href="#if-else语句优化" class="headerlink" title="if&#x2F;else语句优化"></a>if&#x2F;else语句优化</h3><h4 id="排非策略"><a href="#排非策略" class="headerlink" title="排非策略"></a>排非策略</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!user || !password) <span class="keyword">return</span> <span class="keyword">throw</span>(<span class="string">&#x27;用户名和密码不能为空!&#x27;</span>)</span><br><span class="line"><span class="comment">// 逻辑处理</span></span><br></pre></td></tr></table></figure>

<h4 id="三元运算符"><a href="#三元运算符" class="headerlink" title="三元运算符"></a>三元运算符</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> allow = age &gt;= <span class="number">18</span> ? <span class="string">&#x27;通过&#x27;</span> : <span class="string">&#x27;拒绝&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="单个if多条件优化"><a href="#单个if多条件优化" class="headerlink" title="单个if多条件优化"></a>单个if多条件优化</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params">type</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> imgArr = [<span class="string">&#x27;jpg&#x27;</span>, <span class="string">&#x27;png&#x27;</span>, <span class="string">&#x27;gif&#x27;</span>, <span class="string">&#x27;svg&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> (imgArr.<span class="title function_">includes</span>(type)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;该文件为图片&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="key-value"><a href="#key-value" class="headerlink" title="key-value"></a>key-value</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> enums = &#123;</span><br><span class="line">  <span class="string">&#x27;A&#x27;</span>: handleA,</span><br><span class="line">  <span class="string">&#x27;B&#x27;</span>: handleB,</span><br><span class="line">  <span class="string">&#x27;C&#x27;</span>: handleC,</span><br><span class="line">  <span class="string">&#x27;D&#x27;</span>: handleD,</span><br><span class="line">  <span class="string">&#x27;E&#x27;</span>: handleE</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">action</span>(<span class="params">val</span>)&#123;</span><br><span class="line">  <span class="keyword">let</span> handleType = enums[val]</span><br><span class="line">  <span class="title function_">handleType</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Map"><a href="#Map" class="headerlink" title="Map"></a><code>Map</code></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> enums = <span class="keyword">new</span> <span class="title class_">Map</span>([</span><br><span class="line">  [<span class="string">&#x27;A&#x27;</span>, handleA],</span><br><span class="line">  [<span class="string">&#x27;B&#x27;</span>, handleB],</span><br><span class="line">  [<span class="string">&#x27;C&#x27;</span>, handleC],</span><br><span class="line">  [<span class="string">&#x27;D&#x27;</span>, handleD],</span><br><span class="line">  [<span class="string">&#x27;E&#x27;</span>, handleE]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">action</span>(<span class="params">val</span>)&#123;</span><br><span class="line">  <span class="keyword">let</span> handleType = enums.<span class="title function_">get</span>(val)</span><br><span class="line">  <span class="title function_">handleType</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> enums = <span class="keyword">new</span> <span class="title class_">Map</span>([</span><br><span class="line">  [<span class="string">&#x27;kline_A&#x27;</span>, handleKlineA],</span><br><span class="line">  [<span class="string">&#x27;kline_B&#x27;</span>, handleKlineB],</span><br><span class="line">  [<span class="string">&#x27;kline_C&#x27;</span>, handleKlineC],</span><br><span class="line">  [<span class="string">&#x27;kline_D&#x27;</span>, handleKlineD],</span><br><span class="line">  [<span class="string">&#x27;kline_E&#x27;</span>, handleKlineE],</span><br><span class="line">  [<span class="string">&#x27;depth_A&#x27;</span>, handleDepthA],</span><br><span class="line">  [<span class="string">&#x27;depth_B&#x27;</span>, handleDepthB],</span><br><span class="line">  [<span class="string">&#x27;depth_C&#x27;</span>, handleDepthC],</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">action</span>(<span class="params">mode, type</span>)&#123;</span><br><span class="line">  <span class="keyword">let</span> key = <span class="string">`<span class="subst">$&#123;mode&#125;</span>_<span class="subst">$&#123;type&#125;</span>`</span></span><br><span class="line">  <span class="keyword">let</span> handleType = enums.<span class="title function_">get</span>(key)</span><br><span class="line">  <span class="title function_">handleType</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="判断是否为移动端"><a href="#判断是否为移动端" class="headerlink" title="判断是否为移动端"></a>判断是否为移动端</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 判断 pc端移动端</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">isMobile</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> regex_match =</span><br><span class="line">    <span class="regexp">/(nokia|iphone|android|motorola|^mot-|softbank|foma|docomo|kddi|up.browser|up.link|htc|dopod|blazer|netfront|helio|hosin|huawei|novarra|CoolPad|webos|techfaith|palmsource|blackberry|alcatel|amoi|ktouch|nexian|samsung|^sam-|s[cg]h|^lge|ericsson|philips|sagem|wellcom|bunjalloo|maui|symbian|smartphone|midp|wap|phone|windows ce|iemobile|^spice|^bird|^zte-|longcos|pantech|gionee|^sie-|portalmmm|jigs browser|hiptop|^benq|haier|^lct|operas*mobi|opera*mini|320x320|240x320|176x220)/i</span></span><br><span class="line">  <span class="keyword">let</span> u = navigator.<span class="property">userAgent</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="literal">null</span> == u) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> result = regex_match.<span class="title function_">exec</span>(u)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="literal">null</span> == result) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="防抖"><a href="#防抖" class="headerlink" title="防抖"></a>防抖</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 防抖</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Function</span>&#125; fun 需要执行的函数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Number</span>&#125; wait 防抖时间（毫秒）</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Boolean</span>&#125; immediate 是否立即执行</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">debounce</span> = (<span class="params">fun, wait = <span class="number">500</span>, immediate = <span class="literal">true</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> timer = <span class="literal">null</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">...params</span>) &#123;</span><br><span class="line">    <span class="built_in">clearTimeout</span>(timer)</span><br><span class="line">    <span class="keyword">let</span> now = immediate &amp;&amp; !timer</span><br><span class="line">    timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      timer = <span class="literal">null</span></span><br><span class="line">      !immediate ? fun.<span class="title function_">call</span>(<span class="variable language_">this</span>, ...params) : <span class="literal">null</span></span><br><span class="line">    &#125;, wait)</span><br><span class="line">    now ? fun.<span class="title function_">call</span>(<span class="variable language_">this</span>, ...params) : <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>简单版本</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">debounce</span>(<span class="params">fn,delay</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> t = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(t!=<span class="literal">null</span>)&#123;</span><br><span class="line">           <span class="built_in">clearInterval</span>(t)</span><br><span class="line">        &#125;</span><br><span class="line">        t = <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">            <span class="comment">// console.log(this)</span></span><br><span class="line">            <span class="comment">// 使用call改变fn函数this指向</span></span><br><span class="line">            fn.<span class="title function_">call</span>(<span class="variable language_">this</span>)</span><br><span class="line">      &#125;,delay)   </span><br><span class="line"> &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="函数节流"><a href="#函数节流" class="headerlink" title="函数节流"></a><strong>函数节流</strong></h3><ul>
<li>定时器版本</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">throttle</span>(<span class="params">fn,wait</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> timer = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> context = <span class="variable language_">this</span>;</span><br><span class="line">        <span class="keyword">let</span> args = <span class="variable language_">arguments</span>;</span><br><span class="line">        <span class="keyword">if</span>(!timer)&#123;</span><br><span class="line">            timer = <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                fn.<span class="title function_">apply</span>(context,args);</span><br><span class="line">                timer = <span class="literal">null</span>;</span><br><span class="line">            &#125;,wait)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>时间戳</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">throttle</span>(<span class="params">fn,wait</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> pre = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> context = <span class="variable language_">this</span>;</span><br><span class="line">        <span class="keyword">var</span> args = <span class="variable language_">arguments</span>;</span><br><span class="line">        <span class="keyword">var</span> now = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">        <span class="keyword">if</span>( now - pre &gt;= wait)&#123;</span><br><span class="line">            fn.<span class="title function_">apply</span>(context,args);</span><br><span class="line">            pre = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handle</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>());</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;mousemove&quot;</span>,<span class="title function_">throttle</span>(handle,<span class="number">1000</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">throttle</span> = (<span class="params">func, time = <span class="number">17</span>, options = &#123;</span></span><br><span class="line"><span class="params">    // leading 和 trailing 无法同时为 <span class="literal">false</span></span></span><br><span class="line"><span class="params">    leading: <span class="literal">true</span>,</span></span><br><span class="line"><span class="params">    trailing: <span class="literal">false</span>,</span></span><br><span class="line"><span class="params">    context: <span class="literal">null</span></span></span><br><span class="line"><span class="params">&#125;</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> previous = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="number">0</span>).<span class="title function_">getTime</span>()</span><br><span class="line">    <span class="keyword">let</span> timer;</span><br><span class="line">    <span class="keyword">const</span> _throttle = <span class="keyword">function</span> (<span class="params">...args</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!options.<span class="property">leading</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (timer) <span class="keyword">return</span></span><br><span class="line">            timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                timer = <span class="literal">null</span></span><br><span class="line">                func.<span class="title function_">apply</span>(options.<span class="property">context</span>, args)</span><br><span class="line">            &#125;, time)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (now - previous &gt; time) &#123;</span><br><span class="line">            func.<span class="title function_">apply</span>(options.<span class="property">context</span>, args)</span><br><span class="line">            previous = now</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (options.<span class="property">trailing</span>) &#123;</span><br><span class="line">            <span class="built_in">clearTimeout</span>(timer)</span><br><span class="line">            timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                func.<span class="title function_">apply</span>(options.<span class="property">context</span>, args)</span><br><span class="line">            &#125;, time)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    _throttle.<span class="property">cancel</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        previous = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">clearTimeout</span>(timer);</span><br><span class="line">        timer = <span class="literal">null</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> _throttle</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<h3 id="递归子菜单"><a href="#递归子菜单" class="headerlink" title="递归子菜单"></a>递归子菜单</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;部门1&#x27;</span>, <span class="attr">pid</span>: <span class="number">0</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;部门2&#x27;</span>, <span class="attr">pid</span>: <span class="number">1</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">name</span>: <span class="string">&#x27;部门3&#x27;</span>, <span class="attr">pid</span>: <span class="number">1</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">4</span>, <span class="attr">name</span>: <span class="string">&#x27;部门4&#x27;</span>, <span class="attr">pid</span>: <span class="number">3</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">5</span>, <span class="attr">name</span>: <span class="string">&#x27;部门5&#x27;</span>, <span class="attr">pid</span>: <span class="number">4</span> &#125;</span><br><span class="line">]</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getTree</span> = (<span class="params">data</span>)=&gt;&#123;</span><br><span class="line">    <span class="keyword">const</span> result = []</span><br><span class="line">    <span class="keyword">const</span> map = data.<span class="title function_">reduce</span>(<span class="function">(<span class="params">pre,cur</span>)=&gt;</span>&#123;</span><br><span class="line">        pre[cur.<span class="property">id</span>] = cur</span><br><span class="line">        <span class="keyword">return</span> pre</span><br><span class="line">    &#125;,&#123;&#125;)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(map);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> item <span class="keyword">of</span> data)&#123;</span><br><span class="line">        <span class="keyword">if</span>(item.<span class="property">pid</span> === <span class="number">0</span>)&#123;</span><br><span class="line">            result.<span class="title function_">push</span>(item)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(item.<span class="property">pid</span> <span class="keyword">in</span> map)&#123;</span><br><span class="line">            <span class="keyword">const</span> parent = map[item.<span class="property">pid</span>]</span><br><span class="line">            parent.<span class="property">children</span> = parent.<span class="property">children</span> || []</span><br><span class="line">            parent.<span class="property">children</span>.<span class="title function_">push</span>(item)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="确定对象的数据类型"><a href="#确定对象的数据类型" class="headerlink" title="确定对象的数据类型"></a><strong>确定对象的数据类型</strong></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">myType</span>(<span class="params">type</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(type).<span class="title function_">slice</span>(<span class="number">8</span>, -<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<h3 id="使用reduce实现数组过滤方法"><a href="#使用reduce实现数组过滤方法" class="headerlink" title="使用reduce实现数组过滤方法"></a><strong>使用reduce实现数组过滤方法</strong></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myFilter2 = <span class="keyword">function</span> (<span class="params">fn, context</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">reduce</span>(<span class="function">(<span class="params">total, current, index</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> fn.<span class="title function_">call</span>(context, current, index, <span class="variable language_">this</span>) ? [...total, current] : [...total]</span><br><span class="line">    &#125;, [])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="使用reduce实现array的flat方法"><a href="#使用reduce实现array的flat方法" class="headerlink" title="使用reduce实现array的flat方法"></a><strong>使用reduce实现array的flat方法</strong></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// reduce implements array.prototype.flat, Array flat</span></span><br><span class="line"><span class="keyword">const</span> myFlat = <span class="keyword">function</span> (<span class="params">depth = <span class="number">1</span></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> arr = <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">slice</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>)</span><br><span class="line">    <span class="keyword">if</span> (depth === <span class="number">0</span>) <span class="keyword">return</span> arr</span><br><span class="line">    <span class="keyword">return</span> arr.<span class="title function_">reduce</span>(<span class="function">(<span class="params">total, current</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(current)) &#123;</span><br><span class="line">            <span class="comment">// You need to bind this with call, otherwise it points to the window</span></span><br><span class="line">            <span class="keyword">return</span> [...total, ...myFlat.<span class="title function_">call</span>(current, depth-<span class="number">1</span>)]</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> [...total, current]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, [])</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="函数柯里化"><a href="#函数柯里化" class="headerlink" title="函数柯里化"></a>函数柯里化</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">display</span> = (<span class="params">a, b, c, d, e, f</span>) =&gt; [a, b, c, d, e, f];</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">curry</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (fn.<span class="property">length</span> &lt;= <span class="number">1</span>) <span class="keyword">return</span> fn;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">generator</span> = (<span class="params">...args</span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (fn.<span class="property">length</span> === args.<span class="property">length</span>) &#123;</span><br><span class="line">            <span class="comment">//Executes fn and returns the execution result</span></span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">fn</span>(...args)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="function">(<span class="params">...args2</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="comment">//Return generator function</span></span><br><span class="line">                <span class="keyword">return</span> <span class="title function_">generator</span>(...args, ...args2)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> generator</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> curriedDisplay = <span class="title function_">curry</span>(display);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;curriedDisplay&quot;</span>, <span class="title function_">curriedDisplay</span>(<span class="number">1</span>)(<span class="number">2</span>)(<span class="number">3</span>)(<span class="number">4</span>)(<span class="number">5</span>)(<span class="number">6</span>));</span><br></pre></td></tr></table></figure>

<h3 id="图片的延迟加载"><a href="#图片的延迟加载" class="headerlink" title="图片的延迟加载"></a><strong>图片的延迟加载</strong></h3><blockquote>
<p>两种方法 getBoundingClientRect       intersectionObserver</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// getBoundingClientRect lazy Load</span></span><br><span class="line"><span class="keyword">let</span> imgList1 = [...<span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.get_bounding_rect&quot;</span>)]</span><br><span class="line"><span class="keyword">let</span> num = imgList1.<span class="property">length</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> lazyLoad1 = (<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> deleteIndexList = []</span><br><span class="line">        imgList1.<span class="title function_">forEach</span>(<span class="function">(<span class="params">img,index</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> rect = img.<span class="title function_">getBoundingClientRect</span>()</span><br><span class="line">            <span class="keyword">if</span> (rect.<span class="property">top</span> &lt; <span class="variable language_">window</span>.<span class="property">innerHeight</span>) &#123;</span><br><span class="line">                img.<span class="property">src</span> = img.<span class="property">dataset</span>.<span class="property">src</span></span><br><span class="line">                <span class="comment">// Add the image to the remove list after loading successfully</span></span><br><span class="line">                deleteIndexList.<span class="title function_">push</span>(index)</span><br><span class="line">                count++</span><br><span class="line">                <span class="keyword">if</span> (count === num) &#123;</span><br><span class="line">                    <span class="comment">//Unbind the Scroll event when all images are loaded</span></span><br><span class="line">                    <span class="variable language_">document</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>,lazyLoad1)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">// Delete images that have been loaded</span></span><br><span class="line">        imgList1 = imgList1.<span class="title function_">filter</span>(<span class="function">(<span class="params">_,index</span>)=&gt;</span>!deleteIndexList.<span class="title function_">includes</span>(index))</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line"><span class="comment">// The throttling function of throttle.js is referenced here</span></span><br><span class="line">lazyLoad1 = <span class="title function_">proxy</span>(lazyLoad1, <span class="number">100</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, lazyLoad1)</span><br><span class="line"><span class="comment">// Manually load the image once. Otherwise, the image on the first screen cannot be loaded without triggering scrolling</span></span><br><span class="line"><span class="title function_">lazyLoad1</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// intersectionObserver lazy Load</span></span><br><span class="line"><span class="keyword">let</span> imgList2 = [...<span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.intersection_observer&quot;</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> lazyLoad2 = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// instantiation observer</span></span><br><span class="line">    <span class="keyword">let</span> observer = <span class="keyword">new</span> <span class="title class_">IntersectionObserver</span>(<span class="function"><span class="params">entries</span> =&gt;</span> &#123;</span><br><span class="line">        entries.<span class="title function_">forEach</span>(<span class="function"><span class="params">entry</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (entry.<span class="property">intersectionRatio</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                entry.<span class="property">target</span>.<span class="property">src</span> = entry.<span class="property">target</span>.<span class="property">dataset</span>.<span class="property">src</span></span><br><span class="line">                observer.<span class="title function_">unobserve</span>(entry.<span class="property">target</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">    imgList2.<span class="title function_">forEach</span>(<span class="function"><span class="params">img</span> =&gt;</span> &#123;</span><br><span class="line">        observer.<span class="title function_">observe</span>(img)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">lazyLoad2</span>()</span><br></pre></td></tr></table></figure>

<h3 id="js判断是否有滚动条"><a href="#js判断是否有滚动条" class="headerlink" title="js判断是否有滚动条"></a>js判断是否有滚动条</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 判断是否有滚动条</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hasScrolled</span>(<span class="params">element, direction</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (direction === <span class="string">&#x27;vertical&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> element.<span class="property">scrollHeight</span> &gt; element.<span class="property">clientHeight</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (direction === <span class="string">&#x27;horizontal&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> element.<span class="property">scrollWidth</span> &gt; element.<span class="property">clientWidth</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解决滑动穿透</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//锁住身体</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">lockBody</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> zanScrollTop = $(<span class="variable language_">document</span>).<span class="title function_">scrollTop</span>();</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;zanScrollTop&quot;</span>, zanScrollTop)</span><br><span class="line">    $(<span class="string">&#x27;body&#x27;</span>).<span class="title function_">addClass</span>(<span class="string">&#x27;zan-luckbody&#x27;</span>).<span class="title function_">css</span>(&#123; <span class="string">&quot;top&quot;</span>: -zanScrollTop + <span class="string">&quot;px&quot;</span> &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//解锁身体</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">unlockBody</span>(<span class="params"></span>) &#123;</span><br><span class="line">    $(<span class="string">&#x27;body&#x27;</span>).<span class="title function_">removeClass</span>(<span class="string">&#x27;zan-luckbody&#x27;</span>).<span class="title function_">css</span>(&#123; <span class="string">&quot;top&quot;</span>: <span class="string">&quot;&quot;</span> &#125;);</span><br><span class="line">    $(<span class="variable language_">document</span>).<span class="title function_">scrollTop</span>(<span class="variable language_">window</span>.<span class="property">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;zanScrollTop&quot;</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="video-全屏"><a href="#video-全屏" class="headerlink" title="video 全屏"></a>video 全屏</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fullScreen</span>(<span class="params">id</span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> el = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(id)</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;fullscreenchange&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">checkIsFullScreen</span>()) &#123;</span><br><span class="line">          el.<span class="title function_">play</span>()</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          el.<span class="title function_">pause</span>()</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="keyword">if</span> (el.<span class="property">requestFullscreen</span>) &#123;</span><br><span class="line">        el.<span class="title function_">requestFullscreen</span>()</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (el.<span class="property">msRequestFullscreen</span>) &#123;</span><br><span class="line">        el.<span class="title function_">msRequestFullscreen</span>()</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (el.<span class="property">mozRequestFullScreen</span>) &#123;</span><br><span class="line">        el.<span class="title function_">mozRequestFullScreen</span>()</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (el.<span class="property">webkitRequestFullscreen</span>) &#123;</span><br><span class="line">        el.<span class="title function_">webkitRequestFullscreen</span>()</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;不支持全屏!&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">checkIsFullScreen</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> isFullScreen =</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">fullscreen</span> || <span class="variable language_">document</span>.<span class="property">mozFullScreen</span> || <span class="variable language_">document</span>.<span class="property">webkitIsFullScreen</span></span><br><span class="line">      <span class="keyword">return</span> isFullScreen == <span class="literal">undefined</span> ? <span class="literal">false</span> : isFullScreen</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h3 id="JavaScript判断是否是同一天"><a href="#JavaScript判断是否是同一天" class="headerlink" title="JavaScript判断是否是同一天"></a>JavaScript判断是否是同一天</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">isSameDay</span>(<span class="params">startTime, endTime</span>) &#123;</span><br><span class="line">   <span class="keyword">const</span> startTimeMs = <span class="keyword">new</span> <span class="title class_">Date</span>(startTime).<span class="title function_">setHours</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">   <span class="keyword">const</span> endTimeMs = <span class="keyword">new</span> <span class="title class_">Date</span>(endTime).<span class="title function_">setHours</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">   <span class="keyword">return</span> startTimeMs === endTimeMs ? <span class="literal">true</span> : <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="返回类似于微信的时间"><a href="#返回类似于微信的时间" class="headerlink" title="返回类似于微信的时间"></a>返回类似于微信的时间</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//循环处理时间</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 参数</span></span><br><span class="line"><span class="comment"> * arr：数据数组</span></span><br><span class="line"><span class="comment"> * key：数组中对象的时间key键。</span></span><br><span class="line"><span class="comment"> * 新增属性</span></span><br><span class="line"><span class="comment"> * show_time_type：时间的类型</span></span><br><span class="line"><span class="comment"> * show_time：页面展示输出的时间</span></span><br><span class="line"><span class="comment"> * is_show_time：间隔上个时间是否大于5分钟，大于则显示当前时间，反之。</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">checkShowRule</span>(<span class="params">arr, key</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> newArr = arr.<span class="title function_">map</span>(<span class="function">(<span class="params">item, index, array</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> obj = <span class="title function_">toggleTime</span>(item[key])</span><br><span class="line">    item[<span class="string">&#x27;show_time_type&#x27;</span>] = obj.<span class="property">type</span></span><br><span class="line">    item[<span class="string">&#x27;show_time&#x27;</span>] = obj.<span class="property">time</span></span><br><span class="line">    <span class="keyword">if</span> (index &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      item[<span class="string">&#x27;is_show_time&#x27;</span>] = <span class="title function_">compareTimeInterval</span>(array[index - <span class="number">1</span>][key], array[index][key])</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      item[<span class="string">&#x27;is_show_time&#x27;</span>] = <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> item</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> newArr</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//根据不同时间的消息，输出不同的时间格式</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">toggleTime</span>(<span class="params">date</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> time</span><br><span class="line">  <span class="keyword">let</span> type = <span class="title function_">getDateDiff</span>(date)</span><br><span class="line">  <span class="comment">//1：新消息，2：当天消息,3：昨天消息，4：今年消息，5：其他消息</span></span><br><span class="line">  <span class="keyword">if</span> (type == <span class="number">1</span>) &#123;</span><br><span class="line">    time = <span class="string">&#x27;以下为最新消息&#x27;</span> <span class="comment">//新消息，不显示时间，但是要显示&quot;以下为最新消息&quot;</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type == <span class="number">2</span>) &#123;</span><br><span class="line">    time = <span class="title function_">dayjs</span>(date).<span class="title function_">format</span>(<span class="string">&#x27;H:mm&#x27;</span>) <span class="comment">//当天消息，显示：10:22</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type == <span class="number">3</span>) &#123;</span><br><span class="line">    time = <span class="title function_">dayjs</span>(date).<span class="title function_">format</span>(<span class="string">&#x27;昨天 H:mm&#x27;</span>) <span class="comment">//昨天消息，显示：昨天 20:41</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type == <span class="number">4</span>) &#123;</span><br><span class="line">    time = <span class="title function_">dayjs</span>(date).<span class="title function_">format</span>(<span class="string">&#x27;M月D日 AH:mm&#x27;</span>).<span class="title function_">replace</span>(<span class="string">&#x27;AM&#x27;</span>, <span class="string">&#x27;上午&#x27;</span>).<span class="title function_">replace</span>(<span class="string">&#x27;PM&#x27;</span>, <span class="string">&#x27;下午&#x27;</span>) <span class="comment">//今年消息，上午下午，显示：3月17日 下午16:45</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type == <span class="number">5</span>) &#123;</span><br><span class="line">    time = <span class="title function_">dayjs</span>(date).<span class="title function_">format</span>(<span class="string">&#x27;YYYY年M月D日 AH:mm&#x27;</span>).<span class="title function_">replace</span>(<span class="string">&#x27;AM&#x27;</span>, <span class="string">&#x27;上午&#x27;</span>).<span class="title function_">replace</span>(<span class="string">&#x27;PM&#x27;</span>, <span class="string">&#x27;下午&#x27;</span>) <span class="comment">//其他消息，上午下午，显示：2020年11月2日 下午15:17</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">time</span>: time,</span><br><span class="line">    <span class="attr">type</span>: type</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//判断消息类型</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getDateDiff</span>(<span class="params">date</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> nowDate = <span class="title function_">dayjs</span>(<span class="keyword">new</span> <span class="title class_">Date</span>()) <span class="comment">//当前时间</span></span><br><span class="line">  <span class="keyword">let</span> oldDate = <span class="title function_">dayjs</span>(<span class="keyword">new</span> <span class="title class_">Date</span>(date)) <span class="comment">//参数时间</span></span><br><span class="line">  <span class="keyword">let</span> timeTemp = <span class="title function_">dayjs</span>(<span class="title function_">getThisTime</span>().<span class="property">now</span>.<span class="title function_">split</span>(<span class="string">&#x27; &#x27;</span>)[<span class="number">0</span>] + <span class="string">&#x27;00:00&#x27;</span>).<span class="title function_">diff</span>(oldDate, <span class="string">&#x27;hour&#x27;</span>)</span><br><span class="line">  <span class="keyword">let</span> result</span><br><span class="line">  <span class="comment">//优先判断昨天消息。今年的日期00:00的时间与上一个时间的时间戳小于1天，那就判断为昨天消息</span></span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    (nowDate.<span class="title function_">year</span>() - oldDate.<span class="title function_">year</span>() == <span class="number">1</span> || nowDate.<span class="title function_">month</span>() - oldDate.<span class="title function_">month</span>() == <span class="number">1</span>) &amp;&amp;</span><br><span class="line">    timeTemp &gt;= <span class="number">0</span> &amp;&amp;</span><br><span class="line">    timeTemp &lt;= <span class="number">24</span></span><br><span class="line">  ) &#123;</span><br><span class="line">    result = <span class="number">3</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nowDate.<span class="title function_">year</span>() - oldDate.<span class="title function_">year</span>() &gt;= <span class="number">1</span>) &#123;</span><br><span class="line">    result = <span class="number">5</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nowDate.<span class="title function_">month</span>() - oldDate.<span class="title function_">month</span>() &gt;= <span class="number">1</span> || nowDate.<span class="title function_">date</span>() - oldDate.<span class="title function_">date</span>() &gt;= <span class="number">2</span>) &#123;</span><br><span class="line">    result = <span class="number">4</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nowDate.<span class="title function_">date</span>() - oldDate.<span class="title function_">date</span>() &gt;= <span class="number">1</span>) &#123;</span><br><span class="line">    result = <span class="number">3</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nowDate.<span class="title function_">hour</span>() - oldDate.<span class="title function_">hour</span>() &gt;= <span class="number">1</span> || nowDate.<span class="title function_">minute</span>() - oldDate.<span class="title function_">minute</span>() &gt;= <span class="number">5</span>) &#123;</span><br><span class="line">    result = <span class="number">2</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    result = <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//判断两个时间差是否大于5分钟</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">compareTimeInterval</span>(<span class="params">t1, t2</span>) &#123;</span><br><span class="line">  <span class="comment">// console.log(t1,t2,dayjs(t2)-dayjs(t1));</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">dayjs</span>(t2) - <span class="title function_">dayjs</span>(t1) &gt;= <span class="number">300000</span> ? <span class="literal">true</span> : <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取当前时间，当前日期</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getThisTime</span>(<span class="params">timeStamp</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> myDate = timeStamp ? <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="built_in">parseInt</span>(timeStamp) * <span class="number">1000</span>) : <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">p</span>(<span class="params">s</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> s &lt; <span class="number">10</span> ? <span class="string">&#x27;0&#x27;</span> + s : s</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">year</span>: myDate.<span class="title function_">getFullYear</span>(),</span><br><span class="line">    <span class="attr">month</span>: myDate.<span class="title function_">getMonth</span>() + <span class="number">1</span>,</span><br><span class="line">    <span class="attr">date</span>: myDate.<span class="title function_">getDate</span>(),</span><br><span class="line">    <span class="attr">h</span>: myDate.<span class="title function_">getHours</span>(),</span><br><span class="line">    <span class="attr">m</span>: myDate.<span class="title function_">getMinutes</span>(),</span><br><span class="line">    <span class="attr">s</span>: myDate.<span class="title function_">getSeconds</span>(),</span><br><span class="line">    <span class="attr">now</span>:</span><br><span class="line">      myDate.<span class="title function_">getFullYear</span>() +</span><br><span class="line">      <span class="string">&#x27;-&#x27;</span> +</span><br><span class="line">      <span class="title function_">p</span>(myDate.<span class="title function_">getMonth</span>() + <span class="number">1</span>) +</span><br><span class="line">      <span class="string">&#x27;-&#x27;</span> +</span><br><span class="line">      <span class="title function_">p</span>(myDate.<span class="title function_">getDate</span>()) +</span><br><span class="line">      <span class="string">&#x27; &#x27;</span> +</span><br><span class="line">      <span class="title function_">p</span>(myDate.<span class="title function_">getHours</span>()) +</span><br><span class="line">      <span class="string">&#x27;:&#x27;</span> +</span><br><span class="line">      <span class="title function_">p</span>(myDate.<span class="title function_">getMinutes</span>()) +</span><br><span class="line">      <span class="string">&#x27;:&#x27;</span> +</span><br><span class="line">      <span class="title function_">p</span>(myDate.<span class="title function_">getSeconds</span>())</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="下载blob方法"><a href="#下载blob方法" class="headerlink" title="下载blob方法"></a>下载blob方法</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">handleDownload</span> = (<span class="params">url: string, file: File[]</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(url, file)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> blob = <span class="keyword">new</span> <span class="title class_">Blob</span>([&lt;string&gt;url], &#123;</span><br><span class="line">    <span class="comment">//这个里面的data 的二进制文件 创建一个文件对象</span></span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;text/plain;charset=utf-8&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">const</span> a = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;a&#x27;</span>) <span class="keyword">as</span> <span class="title class_">HTMLAnchorElement</span></span><br><span class="line">  a.<span class="property">href</span> = <span class="variable constant_">URL</span>.<span class="title function_">createObjectURL</span>(blob)</span><br><span class="line">  a.<span class="property">download</span> = file[<span class="number">0</span>].<span class="property">name</span></span><br><span class="line">  a.<span class="title function_">click</span>()</span><br><span class="line">  <span class="variable constant_">URL</span>.<span class="title function_">revokeObjectURL</span>(a.<span class="property">href</span>)</span><br><span class="line">  a.<span class="title function_">remove</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="获取本周"><a href="#获取本周" class="headerlink" title="获取本周"></a>获取本周</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">currentWeek</span> () &#123;</span><br><span class="line">	<span class="keyword">const</span> time = &#123;&#125;;</span><br><span class="line">	<span class="comment">// 本周第一天</span></span><br><span class="line">	<span class="keyword">const</span> startTime = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>() - <span class="number">3600</span> * <span class="number">1000</span> * <span class="number">24</span> * (<span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getDay</span>() - <span class="number">1</span>));</span><br><span class="line">	time.<span class="property">dateForm</span> = <span class="title function_">moment</span>(startTime).<span class="title function_">format</span>(<span class="string">&#x27;YYYY-MM-DD&#x27;</span>) + <span class="string">&#x27; 00:00:00&#x27;</span>;</span><br><span class="line">	<span class="comment">// 本周最后一天</span></span><br><span class="line">	<span class="keyword">const</span> endTime = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>() + <span class="number">3600</span> * <span class="number">1000</span> * <span class="number">24</span> * (<span class="number">7</span> - <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getDay</span>()));</span><br><span class="line">	time.<span class="property">dateTo</span> = <span class="title function_">moment</span>(endTime).<span class="title function_">format</span>(<span class="string">&#x27;YYYY-MM-DD&#x27;</span>) + <span class="string">&#x27; 23:59:59&#x27;</span>;</span><br><span class="line">	<span class="keyword">return</span> time;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<h3 id="获取本月"><a href="#获取本月" class="headerlink" title="获取本月"></a>获取本月</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">currentMonth</span> () &#123;</span><br><span class="line">	<span class="keyword">const</span> time = &#123;&#125;;</span><br><span class="line">	<span class="keyword">const</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">	<span class="keyword">const</span> start = date.<span class="title function_">setDate</span>(<span class="number">1</span>); <span class="comment">// 本月第一天</span></span><br><span class="line">	time.<span class="property">dateForm</span> = <span class="title function_">moment</span>(start).<span class="title function_">format</span>(<span class="string">&#x27;YYYY-MM-DD&#x27;</span>) + <span class="string">&#x27; 00:00:00&#x27;</span>;</span><br><span class="line">	<span class="keyword">const</span> end = <span class="keyword">new</span> <span class="title class_">Date</span>(date.<span class="title function_">getFullYear</span>(), date.<span class="title function_">getMonth</span>() + <span class="number">1</span>, <span class="number">0</span>); <span class="comment">// 本月的最后一天</span></span><br><span class="line">	time.<span class="property">dateTo</span> = <span class="title function_">moment</span>(end).<span class="title function_">format</span>(<span class="string">&#x27;YYYY-MM-DD&#x27;</span>) + <span class="string">&#x27; 23:59:59&#x27;</span>;</span><br><span class="line">	<span class="keyword">return</span> time;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="获取当前月得所有天数"><a href="#获取当前月得所有天数" class="headerlink" title="获取当前月得所有天数"></a>获取当前月得所有天数</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">getCountDays</span>(<span class="params"></span>) &#123;</span><br><span class="line">     <span class="keyword">let</span> curDate = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">     <span class="comment">// 获取当前月份</span></span><br><span class="line">     <span class="keyword">let</span> curMonth = curDate.<span class="title function_">getMonth</span>()</span><br><span class="line">     <span class="comment">// 实际月份比curMonth大1，下面将月份设置为下一个月</span></span><br><span class="line">     curDate.<span class="title function_">setMonth</span>(curMonth + <span class="number">1</span>)</span><br><span class="line">     <span class="comment">// 将日期设置为0，表示自动计算为上个月（这里指的是当前月份）的最后一天</span></span><br><span class="line">     curDate.<span class="title function_">setDate</span>(<span class="number">0</span>)</span><br><span class="line">     <span class="comment">// 返回当前月份的天数</span></span><br><span class="line">     <span class="keyword">return</span> curDate.<span class="title function_">getDate</span>()</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">	name:&#x27;&#x27;,</span><br><span class="line">	event:[</span><br><span class="line">		&#123;</span><br><span class="line">			start:&#x27;&#x27;,</span><br><span class="line">			end:&#x27;&#x27;,</span><br><span class="line">			name:&#x27;&#x27;,</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">	]</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
      <div id="reword-out">
        <div id="reward-btn">
          打赏
        </div>
      </div>
      
    </div>
    

    <!-- copyright -->
    
    <div class="declare">
      <ul class="post-copyright">
        <li>
          <i class="ri-copyright-line"></i>
          <strong>版权声明： </strong>
          
          本博客所有文章除特别声明外，著作权归作者所有。转载请注明出处！
          
        </li>
      </ul>
    </div>
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        分享
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=http://example.com/2024/09/08/2024/09/08/%E5%B7%A5%E4%BD%9C%E4%B8%AD%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95/" alt="微信分享二维码">
    </div>
</div>

<div id="share-mask"></div>  
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/hexo_blog/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/hexo_blog/tags/%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95/" rel="tag">常用方法</a></li></ul>

    </footer>
  </div>

   
  <nav class="article-nav">
    
      <a href="/hexo_blog/2024/09/08/2024/09/08/%E9%9D%A2%E8%AF%95%E9%A2%98_js%E8%A1%A5%E5%85%85/" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">
          
            前端面试题 - Javascript补充篇
          
        </div>
      </a>
    
    
      <a href="/hexo_blog/2024/09/08/2024/09/08/%E5%B8%B8%E7%94%A8%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">常用正则表达式</div>
      </a>
    
  </nav>

  
   
  
   
    <script src="https://cdn.staticfile.org/twikoo/1.4.18/twikoo.all.min.js"></script>
    <div id="twikoo" class="twikoo"></div>
    <script>
        twikoo.init({
            envId: ""
        })
    </script>
 
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2024
        <i class="ri-heart-fill heart_icon"></i> Sun Chao Qun
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>访问人数:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>浏览次数:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/hexo_blog/"><img src="/hexo_blog/images/ayer-side.svg" alt="个人博客"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/hexo_blog/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/hexo_blog/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/hexo_blog/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/hexo_blog/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/hexo_blog/tags/%E6%97%85%E8%A1%8C/">旅行</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/hexo_blog/friends">友链</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/hexo_blog/2024/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="搜索">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/hexo_blog/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/hexo_blog/images/alipay.png">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/hexo_blog/images/wechat.png">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/hexo_blog/js/jquery-3.6.0.min.js"></script>
 
<script src="/hexo_blog/js/lazyload.min.js"></script>

<!-- Tocbot -->
 
<script src="/hexo_blog/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: ".tocbot",
    contentSelector: ".article-entry",
    headingSelector: "h1, h2, h3, h4, h5, h6",
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: "main",
    positionFixedSelector: ".tocbot",
    positionFixedClass: "is-position-fixed",
    fixedSidebarOffset: "auto",
  });
</script>

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/hexo_blog/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/hexo_blog/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/hexo_blog/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    

  </div>
</body>

</html>